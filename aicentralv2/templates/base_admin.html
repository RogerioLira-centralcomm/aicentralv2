<!DOCTYPE html>
<html lang="pt-BR" data-theme="centralcomm">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Admin - AIcentral v2{% endblock %}</title>

    <!-- Favicon -->
    <link href="https://framerusercontent.com/images/xlKOUeMNrkAUmU4dlKVlbRZc.png" rel="icon" media="(prefers-color-scheme: light)">
    <link href="https://framerusercontent.com/images/xlKOUeMNrkAUmU4dlKVlbRZc.png" rel="icon" media="(prefers-color-scheme: dark)">

    <!-- Tailwind + DaisyUI -->
    {% if APP_CONFIG.get('USE_CSS_CDN') or not APP_CONFIG.get('HAS_TAILWIND_BUILD') %}
        <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
        <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.2/dist/full.min.css" rel="stylesheet" type="text/css" />
    {% endif %}
    {% if APP_CONFIG.get('HAS_TAILWIND_BUILD') %}
        <link rel="stylesheet" href="{{ url_for('static', filename='css/tailwind/output.css') }}">
    {% endif %}
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

    <!-- Chart.js para gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    {% block styles %}{% endblock %}
</head>
<body class="bg-base-200">
    <div class="drawer lg:drawer-open">
        <input id="admin-drawer" type="checkbox" class="drawer-toggle" />
        <div class="drawer-content flex flex-col">
            <!-- Navbar -->
            <div class="navbar bg-base-100 shadow-lg sticky top-0 z-40">
                <div class="flex-none lg:hidden">
                    <label for="admin-drawer" class="btn btn-square btn-ghost">
                        <i class="fas fa-bars"></i>
                    </label>
                </div>
                <div class="flex-1">
                    <h1 class="text-xl font-bold ml-4">
                        <i class="fas fa-shield-halved text-primary mr-2"></i>
                        Painel Administrativo
                    </h1>
                </div>
                <div class="flex-none gap-2">
                    <!-- User Badge -->
                    <div class="badge badge-primary gap-2">
                        <i class="fas fa-user-shield"></i>
                        <span class="hidden sm:inline">{{ session.user_type|upper }}</span>
                    </div>
                    
                    <!-- User Dropdown -->
                    <div class="dropdown dropdown-end">
                        <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar placeholder">
                            <div class="bg-neutral text-neutral-content rounded-full w-10">
                                <span class="text-sm">{{ session.user_name[0] if session.user_name else 'A' }}</span>
                            </div>
                        </div>
                        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-50 p-2 shadow-lg bg-base-100 rounded-box w-52">
                            <li class="menu-title">
                                <span>{{ session.user_name }}</span>
                            </li>
                            <li><a href="{{ url_for('index') }}"><i class="fas fa-home mr-2"></i>Área do Cliente</a></li>
                            <li><a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt mr-2"></i>Sair</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Page Content -->
            <main class="flex-1 p-4 lg:p-6">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <div class="mb-6 space-y-2">
                            {% for category, message in messages %}
                                <div class="alert {% if category == 'error' %}alert-error{% elif category == 'success' %}alert-success{% elif category == 'warning' %}alert-warning{% else %}alert-info{% endif %} shadow-lg">
                                    <span>{{ message }}</span>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}

                {% block content %}{% endblock %}
            </main>
        </div>

        <!-- Sidebar -->
        <div class="drawer-side z-50">
            <label for="admin-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
            <aside class="bg-base-100 min-h-screen w-64 shadow-xl">
                <!-- Logo -->
                <div class="p-4 border-b border-base-300">
                    <div class="flex items-center gap-3">
                        <div class="avatar placeholder">
                            <div class="bg-primary text-primary-content rounded-lg w-12">
                                <i class="fas fa-shield-halved text-2xl"></i>
                            </div>
                        </div>
                        <div>
                            <h2 class="font-bold text-lg">AIcentral</h2>
                            <p class="text-xs text-base-content/60">Administração</p>
                        </div>
                    </div>
                </div>

                <!-- Menu -->
                <ul class="menu menu-md p-4">
                    <li class="menu-title text-xs uppercase opacity-60">
                        <span>Principal</span>
                    </li>
                    <li>
                        <a href="{{ url_for('admin.admin_dashboard') }}" 
                           class="{% if request.endpoint == 'admin.admin_dashboard' %}active{% endif %}">
                            <i class="fas fa-tachometer-alt w-5"></i>
                            Dashboard
                        </a>
                    </li>

                    <li class="menu-title text-xs uppercase opacity-60 mt-4">
                        <span>Gestão</span>
                    </li>
                    <li>
                        <a href="{{ url_for('contatos') }}"
                           class="{% if request.endpoint == 'contatos' %}active{% endif %}">
                            <i class="fas fa-users w-5"></i>
                            Usuários
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('clientes') }}"
                           class="{% if request.endpoint == 'clientes' %}active{% endif %}">
                            <i class="fas fa-building w-5"></i>
                            Clientes
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('admin.planos_lista') }}"
                           class="{% if 'planos' in request.endpoint %}active{% endif %}">
                            <i class="fas fa-box w-5"></i>
                            Planos
                        </a>
                    </li>
                    <li>
                        <a href="{{ url_for('admin.faturamento_lista') }}"
                           class="{% if 'faturamento' in request.endpoint %}active{% endif %}">
                            <i class="fas fa-file-invoice-dollar w-5"></i>
                            Faturamento
                        </a>
                    </li>

                    <li class="menu-title text-xs uppercase opacity-60 mt-4">
                        <span>Sistema</span>
                    </li>
                    {% if session.user_type == 'superadmin' %}
                    <li>
                        <a href="{{ url_for('admin.sistema_configuracoes') }}"
                           class="{% if 'configuracoes' in request.endpoint %}active{% endif %}">
                            <i class="fas fa-cog w-5"></i>
                            Configurações
                        </a>
                    </li>
                    {% endif %}
                    <li>
                        <a href="{{ url_for('admin.admin_logs') }}"
                           class="{% if 'logs' in request.endpoint %}active{% endif %}">
                            <i class="fas fa-list-ul w-5"></i>
                            Logs de Auditoria
                        </a>
                    </li>

                    <li class="mt-4">
                        <a href="{{ url_for('index') }}" class="text-info">
                            <i class="fas fa-arrow-left w-5"></i>
                            Voltar ao Sistema
                        </a>
                    </li>
                </ul>

                <!-- Footer -->
                <div class="absolute bottom-4 left-4 right-4">
                    <div class="stats stats-vertical shadow bg-base-200">
                        <div class="stat p-3">
                            <div class="stat-title text-xs">Versão</div>
                            <div class="stat-value text-sm">2.0</div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    {% block scripts %}{% endblock %}
</body>
</html>
