{% extends 'base_tailwind.html' %}

{% block title %}{% if plano %}Editar{% else %}Novo{% endif %} Plano - CentralComm AI{% endblock %}

{% block content %}
<div class="p-6">
    <!-- Header -->
    <div class="mb-6">
        <div class="flex items-center justify-between">
            <h1 class="text-3xl font-bold text-text-primary flex items-center">
                <i class="fas fa-layer-group text-primary mr-3"></i>
                {% if plano %}Editar Plano{% else %}Novo Plano{% endif %}
            </h1>
            <div class="flex gap-3">
                <a href="{{ url_for('planos') }}" class="inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 shadow-md">
                    <i class="fas fa-arrow-left mr-2"></i>
                    Voltar
                </a>
            </div>
        </div>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="mb-6 space-y-2">
                {% for category, message in messages %}
                    <div class="flex items-center p-4 rounded-lg shadow-md {% if category == 'error' %}bg-red-50 text-red-800 border border-red-200{% elif category == 'success' %}bg-green-50 text-green-800 border border-green-200{% elif category == 'warning' %}bg-yellow-50 text-yellow-800 border border-yellow-200{% else %}bg-blue-50 text-blue-800 border border-blue-200{% endif %}">
                        <i class="fas fa-{% if category == 'error' %}exclamation-circle{% elif category == 'success' %}check-circle{% elif category == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %} mr-3"></i>
                        <span class="flex-1">{{ message }}</span>
                        <button onclick="closeFlashMessage(this)" class="ml-4 text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Form -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <form method="POST">
            <!-- Descrição -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-tag mr-2 text-gray-500"></i>
                    Descrição
                    <span class="text-red-500">*</span>
                </label>
                <input 
                    type="text" 
                    name="descricao" 
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50"
                    value="{{ plano.descricao if plano else '' }}"
                    required
                    autofocus
                    maxlength="100"
                    placeholder="Ex: Plano Básico"
                >
            </div>

            <!-- Tokens -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-coins mr-2 text-gray-500"></i>
                    Quantidade de Tokens
                    <span class="text-red-500">*</span>
                </label>
                <input 
                    type="number" 
                    name="tokens" 
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50"
                    value="{{ plano.tokens if plano else '' }}"
                    required
                    min="1"
                    placeholder="Ex: 1000"
                >
            </div>

            <!-- Actions -->
            <div class="flex justify-end space-x-4 mt-8">
                <a href="{{ url_for('planos') }}" class="inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 shadow-md">
                    <i class="fas fa-times mr-2"></i>
                    Cancelar
                </a>
                <button type="submit" class="inline-flex items-center px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-light transition-colors duration-200 shadow-md">
                    <i class="fas fa-save mr-2"></i>
                    {% if plano %}Atualizar{% else %}Cadastrar{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function closeFlashMessage(button) {
    button.parentElement.remove();
}
</script>
{% endblock %}